; Top Design: "PA_Impedance_Matching_Semester_Thesis_3_lib:Step9_S21_optimised:schematic"
; Netlisted using Hierarchy Policy: "Standard"

Options ResourceUsage=yes UseNutmegFormat=no EnableOptim=yes TopDesignName="PA_Impedance_Matching_Semester_Thesis_3_lib:Step9_S21_optimised:schematic" DcopOutputNodeVoltages=yes DcopOutputPinCurrents=yes DcopOutputAllSweepPoints=no DcopOutputDcopType=0
; Library Name: PA_Impedance_Matching_Semester_Thesis_3_lib
; Cell Name: Step5_EM_Model of complete_Matching_Circuit
; View Name: emModel
define "Step5_EM_Model#20of#20complete_Matching_Circuit" ( P1  P2  P3  P4  P5  P6  P7  P8  P9  P10  P11  P12  P13  P14  P15  P16  P17  P18  ref=0 ) 
parameters  l1=3.0001 mm  l2=11.0214 mm  l3=1.3595 mm  l4=0.10001 mm  l5=1.95338 mm  l6=0.250054 mm  l7=1.04384 mm  l8=9.00001 mm  l9=5.85671 mm 
; MomCmpt model has node 0 as implicit reference. Ref node will be ignored and assumed to be grounded!
em_data_name="PA_Impedance_Matching_Semester_Thesis_3_lib:Step5_EM_Model of complete_Matching_Circuit:emModel"
em_data_p0="l1"
em_data_v0=l1
em_data_p1="l2"
em_data_v1=l2
em_data_p2="l3"
em_data_v2=l3
em_data_p3="l4"
em_data_v3=l4
em_data_p4="l5"
em_data_v4=l5
em_data_p5="l6"
em_data_v5=l6
em_data_p6="l7"
em_data_v6=l7
em_data_p7="l8"
em_data_v7=l8
em_data_p8="l9"
em_data_v8=l9
MomCmpt:em_data  P1 P2 P3 P4 P5 P6 P7 P8 P9 P10 \
   P11 P12 P13 P14 P15 P16 P17 P18 \
    name=em_data_name \
    paramFile="" \
    modelFile="C:/Users/johnd/Documents/PA_Impedance_Matching_Semester_Thesis_3/PA_Impedance_Matching_Semester_Thesis_3_lib/%Step5_%E%M_%Model#20of#20complete_%Matching_%Circuit/em%Model/model.ndx" \
    p0="l1" v0=l1 v0_Resolution=0.0001 mm \
    p1="l2" v1=l2 v1_Resolution=0.0001 mm \
    p2="l3" v2=l3 v2_Resolution=0.0001 mm \
    p3="l4" v3=l4 v3_Resolution=0.0001 mm \
    p4="l5" v4=l5 v4_Resolution=0.0001 mm \
    p5="l6" v5=l6 v5_Resolution=0.0001 mm \
    p6="l7" v6=l7 v6_Resolution=0.0001 mm \
    p7="l8" v7=l8 v7_Resolution=0.0001 mm \
    p8="l9" v8=l9 v8_Resolution=0.0001 mm \
    ModelReuse=1 \
    ModelType="MOMMW" \
    ExtrapolationMode="linear" \
    EnforcePassivity=-1
end "Step5_EM_Model#20of#20complete_Matching_Circuit"

"Step5_EM_Model#20of#20complete_Matching_Circuit":X1  N__10 N__9 N__14 N__13 N__15 0 N__11 N__12 N__7 N__8 N__6 0 N__4 N__3 N__5 0 N__1 N__0 l1=3.0001 mm notune{ 1.5 mm to 4.5 mm by 0.3 mm } opt{ 1.5 mm to 4.5 mm } l2=11.0214 mm opt{ 5.51 mm to 16.5 mm } l3=1.3595 mm opt{ 0.68 mm to 2.04 mm } l4=0.10001 mm opt{ 0.1 mm to 0.15 mm } l5=1.95338 mm opt{ 0.977 mm to 2.93 mm } l6=0.250054 mm opt{ 0.125 mm to 0.375 mm } l7=1.04384 mm opt{ 0.522 mm to 1.57 mm } l8=9.00001 mm opt{ 4.5 mm to 13.5 mm } l9=5.85671 mm opt{ 2.93 mm to 8.79 mm } 
#uselib "ckt" , "S2P"
S2P:ATC600L_4P7  N__14 N__13 0 File="C:\Users\johnd\Documents\PA_Impedance_Matching_Semester_Thesis_3\data\600L_S2P_Horz\600L4R7.S2P" Type="touchstone" InterpMode="linear" InterpDom="" ExtrapMode="constant" Temp=27.0 CheckPassivity=0 
#uselib "ckt" , "S2P"
S2P:ATC600L_2P7  N__15 0 0 File="C:\Users\johnd\Documents\PA_Impedance_Matching_Semester_Thesis_3\data\600L_S2P_Horz\600L2R7.S2P" Type="touchstone" InterpMode="linear" InterpDom="" ExtrapMode="constant" Temp=27.0 CheckPassivity=0 
R:R2  N__11 N__12 R=0 Ohm Noise=yes 
#uselib "ckt" , "S2P"
S2P:SNP1  N__7 N__8 0 File="C:\Users\johnd\Documents\PA_Impedance_Matching_Semester_Thesis_3\data\TQP9111.s2p" Type="touchstone" InterpMode="linear" InterpDom="" ExtrapMode="constant" Temp=27.0 CheckPassivity=0 
#uselib "ckt" , "S2P"
S2P:ATC600L_3P0  N__6 0 0 File="C:\Users\johnd\Documents\PA_Impedance_Matching_Semester_Thesis_3\data\600L_S2P_Horz\600L3R0.S2P" Type="touchstone" InterpMode="linear" InterpDom="" ExtrapMode="constant" Temp=27.0 CheckPassivity=0 
#uselib "ckt" , "S2P"
S2P:MURATA_1N  N__4 N__3 0 File="C:\Users\johnd\Documents\PA_Impedance_Matching_Semester_Thesis_3\data\LQG15hn\LQG15HN1N0B02.s2p" Type="touchstone" InterpMode="linear" InterpDom="" ExtrapMode="constant" Temp=27.0 CheckPassivity=0 
#uselib "ckt" , "S2P"
S2P:ATC600L_1P5  N__5 0 0 File="C:\Users\johnd\Documents\PA_Impedance_Matching_Semester_Thesis_3\data\600L_S2P_Horz\600L1R5.S2P" Type="touchstone" InterpMode="linear" InterpDom="" ExtrapMode="constant" Temp=27.0 CheckPassivity=0 
#uselib "ckt" , "S2P"
S2P:ATC600S_100P0  N__1 N__0 0 File="C:\Users\johnd\Documents\PA_Impedance_Matching_Semester_Thesis_3\data\600S_S2P_Horiz\600S101.S2P" Type="touchstone" InterpMode="linear" InterpDom="" ExtrapMode="constant" Temp=27.0 CheckPassivity=0 
S_Param:SP1 CalcS=yes CalcY=no CalcZ=no GroupDelayAperture=1e-4 FreqConversion=no FreqConversionPort=1 StatusLevel=2 CalcNoise=no SortNoise=0 BandwidthForNoise=1.0 Hz DevOpPtLevel=0 SPSS_WSP=yes \
SweepVar="freq" SweepPlan="SP1_stim" OutputPlan="SP1_Output" 

SweepPlan: SP1_stim Start=0.1 GHz Stop=3 GHz Step=1 MHz 

OutputPlan:SP1_Output \
      Type="Output" \
      UseEquationNestLevel=yes \
      EquationNestLevel=2 \
      UseSavedEquationNestLevel=yes \
      SavedEquationNestLevel=2

#load "python","LinearCollapse"
Component Module="LinearCollapse" Type="ModelExtractor" NetworkRepresentation=2
Port:TermG1  N__10 0 Num=1 Z=50 Ohm Noise=yes 
Port:TermG2  N__9 0 Num=2 Z=50 Ohm Noise=yes 

Optim:"Optim1" OptimType="random" ErrorForm="L2" SAProgressReport=0 MaxIters=30 P=2 DesiredError=0.0 StatusLevel=4 FinalAnalysis="None" NormalizeGoals=yes SetBestValues=yes SaveSolns=yes SaveGoals=yes SaveOptimVars=no UpdateDataset=yes SaveNominal=no SaveAllIterations=no UseAllOptVars=yes UseAllGoals=yes SaveCurrentEF=no InitialTempControlMode=0 SANumTrialsPerIter=10 NumShootsPerIter=20 SATempControlAlpha=0.8 EnableCockpit=yes NormalizeError=yes SaveAllTrials=no UseAdvTermCriteria=no CostRelativeTol=1.0e-8 LimitOfContSmallImprovement=5 

OptimGoal:OptimGoal1 Expr="dB(S(2,1))" SimInstanceName="SP1" Weight=1.0 \
IndepVar[1]="freq" \
SpecLimitLine[1]="OptimGoal1_limit1" 
SpecLimitLine:"OptimGoal1_limit1" Type="GreaterThan" Min=28 Weight=1.0 \
IndepVar[1]="freq" IndepMin[1]=2.4 GHz IndepMax[1]=2.406 GHz 
